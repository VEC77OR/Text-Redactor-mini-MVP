# –ò–º—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
VENV = venv
PYTHON = $(VENV)/bin/python
PIP = $(VENV)/bin/pip

# ------------------------------
# –°–æ–∑–¥–∞—Ç—å venv
# ------------------------------
venv:
	python3 -m venv $(VENV)
	@echo "‚úîÔ∏è  –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ."

# ------------------------------
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
# ------------------------------
install: venv
	$(PIP) install --upgrade pip
	$(PIP) install -r requirements.txt
	@echo "‚úîÔ∏è  –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã."

# ------------------------------
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
# ------------------------------
start:
	$(PYTHON) -m uvicorn app.main:app --reload

# ------------------------------
# –ü–æ–∏—Å–∫ –∏ —É–±–∏–π—Å—Ç–≤–æ uvicorn
# ------------------------------
stop:
	@pkill -f "uvicorn app.main:app" || true
	@echo "üõë  –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã uvicorn –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã."

# ------------------------------
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
# ------------------------------
restart: stop start

# ------------------------------
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# ------------------------------
create-user:
	$(PYTHON) -m app.create_test_user

